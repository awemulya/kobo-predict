{% extends "fieldsight/fieldsight_base.html" %}
{% load i18n staticfiles %}
{% load filters %}

{% block page-title %}{% trans 'Site Dashboard' %}{% endblock %}
{%block extracss %}
    <link rel="stylesheet" href="{% static 'css/leaflet.css' %}">
    <link rel="stylesheet" href="{% static 'css/MarkerCluster.css' %}">
    <link rel="stylesheet" href="{% static 'css/MarkerCluster.Default.css' %}">
{% endblock %}

{% block head %}
    <a class="setting-btn" href="{% url 'fieldsight:site-edit' obj.pk %}"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
    
{% endblock %}

{% block breadcrumbs %}
 {% ifrole "Project" %}
    <li><a href="{% url 'fieldsight:project-dashboard' obj.project.pk %}">{{obj.project.name}}</a></li>
 {% endrole %}
    <li>{{obj.name}}</li>
{% endblock %}
{% block content %}





	<div class="organization-detail-page">


        <div class="organization-short-detail">
                <div class="org-grg">
                    <div class="col-md-3">
                        <div class="org-logo">
                            <img src="{{ obj.logo.url }}" title="{{ obj.logo}}" />
                        </div>
                    </div>
                    <div class="col-md-9">
                        <div class="abt-org">
                            <div class="col-md-6">
                              <h3>{{ obj.name }}</h3>
                              <h3>{{ obj.identifier }}</h3>
                              <p class="address"><span><i class="fa fa-map-marker" aria-hidden="true"></i></span>{{ obj.address }}</p>
                              
                              <p class="contact"><span><i class="fa fa-phone" aria-hidden="true"></i></span>{{ obj.phone }}</p>
                              <p class="fax"><span><i class="fa fa-fax" aria-hidden="true"></i></span>{{ obj.fax }}</p>
                              <p class="website"><span></span>{{ obj.website }}</p>
  							              <p class="short-detail">{{ obj.description }}</p>
                              <p class="progress-of-site">{% trans 'Progress' %}</p>
                              <div class="progreess">
                                <div class="col-md-9">
                                  <div class="progress progress-striped active progress-sm">
                                      <div class="progress-bar progress-bar-success" role="progressbar"
                                           aria-valuenow="{{obj.progress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{ obj.progress }}%">
                                          <span class="sr-only">{{ obj.progress }}% Complete</span>
                                          <span class="progress-bar-value">{{ obj.progress }}%</span>
                                      </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div id="org-map" class="tab-pane fade in active">
                                 <div class="map-container-fieldsight">
                                    <div id="map" style="height:260px"></div>
                                    <div class="popop-container"  style="display:none">
                                        <h3 class="popop-head"></h3>
                                        <p class="address-popop"></p>
                                        <p class="contact-popop"></p>
                                        <div class="popop-gallery">

                                        </div>
                                    </div>
                                  </div>
                              </div>
                              <!-- <a class="manage-button" href="{% url 'fieldsight:site-blue-prints' obj.pk %}">{% trans 'Add BluePrints' %}</a>
                              <a href="{% url 'forms:setup-site-stages' obj.pk %}" class="manage-button">{% trans 'Stages' %}</a>
                              <a href="{% url 'forms:site-survey' obj.pk %}" class="manage-button">{% trans 'Survey' %}</a>
                              <a href="{% url 'fieldsight:add_supervisor' obj.pk %}" class="manage-button">{% trans 'Assign People' %}</a>
                              <a href="{% url 'forms:site-responses' obj.pk %}" class="manage-button">{% trans 'Responses' %}</a> -->
                            </div>  
                        </div>
                    </div>
                    
                    <div class="clearfixx"></div>
                </div>

        </div>
        <div class="organization-long-detail">
        	<!-- <div class="col-md-6">
                <ul class="nav nav-tabs">
                  <li class="active"><a data-toggle="tab" href="#org-map">Map View</a></li>
                  <li><a data-toggle="tab" href="#org-people">People Involved</a></li>
                  <li><a data-toggle="tab" href="#org-about">About Site</a></li>
                  <li><a data-toggle="tab" href="#org-blueprint">Blueprint</a></li>
                </ul>

                <div class="tab-content">
                  <div id="org-map" class="tab-pane fade in active">
                     <div class="map-container-fieldsight">
                        <div id="map"></div>
                        <div class="popop-container">
                            <h3 class="popop-head"></h3>
                            <p class="address-popop"></p>
                            <p class="contact-popop">01-1234567</p>
                            <div class="popop-gallery">

                            </div>
                        </div>
                      </div>
                  </div>
                  
                  
                  <div id="org-people" class="tab-pane fade">

                     <div class="org-site-list">

                        {% for role in peoples_involved %}

                        <a href="{% url 'users:profile' role.user.id %}">
                            <div class="org-site">
                                
                                <div class="col-md-10">
                                      <div class="detail-org">
                                    <h3 class="pople-Name-org">{{role.user.get_full_name}}</h3>
                                    <p class="address"><span><i class="fa fa-user" aria-hidden="true"></i>
                                    </span>{{ role.user.username }}</p>
                                    <p class="address"><span><i class="fa fa-envelope" aria-hidden="true">

                                    </i></span>{{ role.user.email }}</p>
                                    <p class="address"><span><i class="fa fa-phone" aria-hidden="true"></i>
                                        </span>{{ role.user.user_profile.phone }}</p>

                                    <p class="contact"><span><i class="fa fa-minus" aria-hidden="true"></i></span>
                                    {{ role.group }}
                                    </p>
                                </div>
                                </div>
                                <div class="clearfixx"></div>
                            </div>
                        </a>
                        {% endfor %}
                     </div>
                  </div>
                  <div id="org-about" class="tab-pane fade">
                     <div class="about-organization">
                      <p>{{obj.public_desc}}</p>
                     </div>
                  </div>
                  <div id="org-blueprint" class="tab-pane fade">
                     <div class="about-organization-blueprint">
                      {% for image in obj.blueprints.all %}
                         <div class="org-logo">
                            <img src="{{ image.image.url }}" />
                        </div>
                         {% endfor %}
                     </div>
                  </div>
                </div>    
          </div> -->
            <div class="col-md-12">
                <div class="outstanding-and-all">
                    <ul class="nav nav-tabs">
                      <!-- <li class="all active"><a data-toggle="tab" href="#out-all">All ({{all|length}})</a></li> -->
                      <li class="out active"><a data-toggle="tab" href="#out-standing">Outstanding ({{outstanding|length}})</a></li>
                        <li class="reg"><a data-toggle="tab" href="#out-reject">Rejected ({{rejected|length}})</a></li>
                        <li class="flag"><a data-toggle="tab" href="#out-flagged">Flagged ({{flagged|length}})</a></li>

                        <ul class="nav navbar-nav navbar-right">
                         <li class="responses-all"><a href="{% url 'forms:site-responses' obj.pk %}">{% trans 'Responses' %}</a></li>
                         <li class="dropdown man-drop">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Manage <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                              <li><a href="{% url 'forms:setup-forms' 0 obj.pk %}">{% trans 'Forms' %}</a></li>
                              <li><a href="{% url 'fieldsight:manage-people-site' obj.pk %}">{% trans 'People' %}</a></li>
                              <!-- <li><a href="{% url 'forms:project-schedule-add' obj.pk %}">{% trans 'Forms' %}</a></li>
                              <li><a href="{% url 'fieldsight:add_project_staffs' obj.pk %}">{% trans 'People' %}</a></li> -->
                            </ul>
                        </li>  
                       </ul>

                    </ul>

                    <div class="tab-content">
                      <!-- <div id="out-all" class="tab-pane fade in active">
                        <div class="org-site-list">
                            <div class="form-list">
                                {% for form in all %}
                                <a href="{% url 'forms:instance' form.fsid %}#/{{ form.instance|stringformat:'d' }}">
                                    <div class="org-site">
                                        
                                        <div class="">
                                            <div class="detail-org">
                                              
                                              <h4 class="address">{{ form.fsform.xf.title}}</h4>
                                              <div class="detail-person-time">
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-user"></i></span>{{ form.submitted_by }}</span>
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-clock-o" aria-hidden="true"></i></span>{{ form.submission_time }}</span>  
                                              </div>
                                              <div class="clearfixx"></div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                      </div> -->
                      <div id="out-standing" class="tab-pane fade in active">
                        <div class="org-site-list">
                            <div class="form-list">
                                {% for form in outstanding %}
                                <a href="{% url 'forms:instance' form.fsid %}#/{{ form.instance|stringformat:'d' }}">
                                    <div class="org-site">
                                        
                                        <div class="">
                                            <div class="detail-org">
                                              
                                              <h4 class="address">{{ form.fsform.xf.title}}</h4>
                                              <div class="detail-person-time">
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-user"></i></span>{{ form.submitted_by }}</span>
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-clock-o" aria-hidden="true"></i></span>{{ form.submission_time }}</span>  
                                              </div>
                                              <div class="clearfixx"></div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                      </div>
                      <div id="out-reject" class="tab-pane fade">
                        <div class="org-site-list">
                            <div class="form-list">
                                {% for form in rejected %}
                                <a href="{% url 'forms:instance' form.fsid %}#/{{ form.instance|stringformat:'d' }}">
                                    <div class="org-site">
                                        
                                      <div class="">
                                            <div class="detail-org">
                                              
                                              <h4 class="address">{{ form.fsform.xf.title}}</h4>
                                             <div class="detail-person-time">
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-user"></i></span>{{ form.submitted_by }}</span>
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-clock-o" aria-hidden="true"></i></span>{{ form.submission_time }}</span>  
                                              </div>
                                              <div class="clearfixx"></div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                                 {% endfor %}

                            </div>
                        </div>
                      </div>
                      <div id="out-flagged" class="tab-pane fade">
                        <div class="org-site-list">
                            <div class="form-list">
                                {% for form in flagged %}
                                <a href="{% url 'forms:instance' form.fsid %}#/{{ form.instance|stringformat:'d' }}">
                                    <div class="org-site">

                                      <div class="">
                                            <div class="detail-org">
                                                
                                                <h4 class="address">{{ form.fsform.xf.title}}</h4>
                                                <div class="detail-person-time">
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-user"></i></span>{{ form.submitted_by }}</span>
                                                <span class="site_icon_float"><span class="site_list_icon"><i class="fa fa-clock-o" aria-hidden="true"></i></span>{{ form.submission_time }}</span>  
                                              </div>
                                              <div class="clearfixx"></div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                                 {% endfor %}
                            </div>
                        </div>
                      </div>
                    </div>  
                </div>  
            </div>
        </div>



    </div>

{% endblock %}


{% block all_diagrams %} 
    <section class="panel bar-gauge-diagrams">
        <div class="col-md-6">
          <div class="daily-visit">
              <h4 class="widget-h">Form Submitions</h4>
              <div id="daily-visit-chart" style="width:100%; height: 100px; display: block">

              </div>
              <ul class="chart-meta clearfix">
                  <li class="pull-left visit-chart-value">3233</li>
                  <li class="pull-right visit-chart-title"><i class="fa fa-arrow-up"></i> 15%</li>
              </ul>
          </div>
        </div>
        <div class="col-md-6">
         <div class="top-stats-panel">
            <h4 class="widget-h">Site Progress</h4>
            <div class="bar-stats">
                <ul class="progress-stat-bar clearfix">
                    <li data-percent="50%"><span class="progress-stat-percent pink"></span></li>
                    <li data-percent="90%"><span class="progress-stat-percent"></span></li>
                    <li data-percent="70%"><span class="progress-stat-percent yellow-b"></span></li>
                </ul>
                <!--<ul class="bar-legend">-->
                    <!--<li><span class="bar-legend-pointer pink"></span> New York</li>-->
                    <!--<li><span class="bar-legend-pointer green"></span> Los Angels</li>-->
                    <!--<li><span class="bar-legend-pointer yellow-b"></span> Dallas</li>-->
                <!--</ul>-->
                <div class="daily-sales-info">
                    <span class="sales-count">1200 </span> <span class="sales-label"></span>
                </div>
            </div>
          </div> 
        </div>

        <div class="clearfixx"></div>
        <div class="flags-dash text-center">
          <div class="col-md-3">
            <div class="out-dash-flag">
              <p class="length-flags-forms">{{outstanding|length}}</p>
              <p class="flags-forms">outstanding subs</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="flag-dash-flag">
              <p class="length-flags-forms">{{flagged|length}}</p>
              <p class="flags-forms">flagged subs</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="reg-dash-flag">
              <p class="length-flags-forms">{{rejected|length}}</p>
              <p class="flags-forms">rejected subs</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="app-dash-flag">
              <p class="length-flags-forms">{{approved|length}}</p>
              <p class="flags-forms">approved subs</p>
            </div>
          </div>
          <div class="clearfixx"></div>
        </div>
    </section>             
  {% endblock %} 
    {%block extrascript %}
    <script type="text/javascript" src="{{ STATIC_URL }}js/map/leaflet.js"></script>

    <script type="text/javascript" src="{{ STATIC_URL }}js/map/leaflet.ajax.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/map/textLabel.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/map/leaflet.markercluster-src.js"></script>

    <script src="http://maps.google.com/maps/api/js?v=3&key=AIzaSyC8uXN1u5FYIaGOUnVK90Rh3wR2Gmyw1uU"></script>
  <script type="text/javascript">
     var static_url ="{{ STATIC_URL }}";
    var data = {{ data|safe}};

    </script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/map.js"></script>
{% endblock %}